<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width" />
		<meta name="generator" content={Astro.generator} />
		<title>Astro</title>
	</head>
	<body>
		<div class="container">
      <h1>Loading...</h1>
    </div>

    <script>
      const loadProfile = async () => {
        const res = await fetch('http://localhost:3000/api/protected', {
          credentials: 'include'
        })
        const data = await res.json()

        if (res.ok) {
          (document.querySelector('h1') as HTMLHeadingElement).innerText = data.username
        } else {
          console.error(data)
          // window.location.href = "/"
        }
      }

      loadProfile()
    </script>
  </body>
</html>